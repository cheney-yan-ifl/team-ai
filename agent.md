# Agent Specification

Grounded in the PRD for the Slack‑like multi‑agent AI chat app. This document defines the initial agent types, roles, behaviors, and state hooks to align the system before implementation. Update as the session-state tool and UI details evolve.

## Agent Types
- **Primary Agent (Execution Lead):** Handles user requests inside a topic, owns the main task, and drives workflows to completion.
- **Observer Agents (Monitors/Critics/Planners):** Watch conversations and session state, surface risks, propose improvements, and may trigger automated reactions. Multiple observers can be active.

## Core Responsibilities
- **Primary Agent**
  - Interpret user intents, plan and execute tasks within the topic.
  - Keep the session state current (status, workflow step, blockers, outputs).
  - Coordinate with invited observers and incorporate their feedback.
- **Observer Agents**
  - Monitor messages and state transitions for issues, quality, or policy adherence.
  - Suggest course corrections, highlight risks, and recommend next steps.
  - Trigger reactions or workflows when state rules match (per external tool).

## Session State Interaction
- **State Object (per topic):** Tracks status, workflow step, involved agents, artifacts/links, and notable events.
- **State Changes:** Generated by user actions, primary agent updates, or external tool events.
- **Reactions:** Observers (or automation) respond to state deltas; primary agent merges valid feedback and updates the state again as needed.
- **UI Hooks:** State changes should surface in the context panel and inline system events (see PRD).

## Typical Workflow
1. **Topic Start:** Default primary agent joins; session state initialized.
2. **Agent Invitation:** User invites observers from the agent list; they subscribe to state and chat.
3. **Execution Loop:** Primary executes tasks; observers monitor and react to state changes.
4. **Feedback Integration:** Primary reviews observer feedback, updates state, and communicates results.
5. **Completion/Hand‑off:** State reflects final status; observers quiet unless reactivated.

## Agent Personas (initial sketch)
- **Execution Lead (Primary):** Goal-oriented, concise, keeps users unblocked.
- **Critic (Observer):** Quality and risk focus; highlights gaps and edge cases.
- **Planner (Observer):** Breaks work into steps; suggests ordering and dependencies.
- **Analyst (Observer):** Summarizes context; tracks metrics or data needs.

## Communication Rules
- Mentions via `@agent` in chat to direct messages.
- Slash commands can request actions or state updates (e.g., `/set_state`, `/action`).
- Observer outputs should be visually distinct in the UI (per PRD main chat guidance).

## Open Items / To Refine
- Exact schema and API of the external state-reaction tool.
- How many observers are allowed concurrently; prioritization when conflicts occur.
- Where observer commentary appears when threads are enabled.
- Latency/throughput expectations for live updates and state propagation.
